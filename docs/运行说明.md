# 项目运行说明

## 环境配置

### 1. JDK环境

确保已安装JDK 17或更高版本：

```bash
java -version
```

如果未安装，请从Oracle官网或OpenJDK下载安装。

### 2. Maven环境

确保已安装Maven 3.6或更高版本：

```bash
mvn -version
```

如果未安装，请从Apache Maven官网下载安装。

### 3. MySQL数据库

确保已安装MySQL 8.0或更高版本，并创建数据库：

```sql
-- 登录MySQL
mysql -u root -p

-- 执行数据库初始化脚本
source src/main/resources/db/schema.sql
```

或手动创建数据库：

```sql
CREATE DATABASE swagger_parser DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

## 配置数据库连接

编辑 `src/main/resources/application.yml` 文件，修改数据库连接信息：

```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/swagger_parser?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true
    username: root
    password: your_password  # 修改为你的MySQL密码
```

## 启动步骤

### 方式一：使用Maven命令启动

```bash
# 进入项目根目录
cd D:\workspace\simulater2

# 编译项目
mvn clean compile

# 运行项目
mvn spring-boot:run
```

### 方式二：使用IDE启动

1. 使用IntelliJ IDEA或Eclipse打开项目
2. 等待Maven自动下载依赖
3. 找到 `SwaggerParserApplication.java` 主类
4. 右键选择"Run"或"Debug"

### 方式三：打包后运行

```bash
# 打包项目
mvn clean package

# 运行jar包
java -jar target/swagger-parser-1.0.0.jar
```

## 验证运行

启动成功后，访问以下URL验证：

- 接口列表：http://localhost:8080/api/swagger/apis
- 健康检查：http://localhost:8080/api/swagger/apis?page=0&size=10

如果返回JSON数据，说明项目运行成功。

## 接口调用示例

### 1. 导入Swagger文档

使用Postman或curl工具调用：

```bash
curl -X POST http://localhost:8080/api/swagger/import \
  -H "Content-Type: application/json" \
  -d '{
    "content": "{\"openapi\":\"3.0.0\",\"info\":{\"title\":\"测试API\",\"version\":\"1.0.0\"},\"paths\":{}}",
    "contentType": "json"
  }'
```

或通过URL导入：

```bash
curl -X POST http://localhost:8080/api/swagger/import \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://petstore.swagger.io/v2/swagger.json",
    "contentType": "json"
  }'
```

### 2. 查询接口列表

```bash
curl http://localhost:8080/api/swagger/apis?page=0&size=10
```

### 3. 获取接口详情

```bash
curl http://localhost:8080/api/swagger/apis/1
```

### 4. 查询请求参数

```bash
# 查询所有请求参数
curl http://localhost:8080/api/swagger/apis/1/request-params

# 按位置查询
curl http://localhost:8080/api/swagger/apis/1/request-params?location=query
```

## 常见问题

### Q1: 启动失败，提示数据库连接失败

**解决方案**:
1. 检查MySQL服务是否启动
2. 检查数据库连接配置是否正确
3. 检查数据库用户权限
4. 确保数据库已创建

### Q2: 启动失败，提示端口被占用

**解决方案**:
1. 修改 `application.yml` 中的端口号：
   ```yaml
   server:
     port: 8081  # 改为其他端口
   ```
2. 或关闭占用8080端口的程序

### Q3: Maven依赖下载失败

**解决方案**:
1. 检查网络连接
2. 配置Maven镜像（推荐使用阿里云镜像）
3. 删除本地仓库中的相关依赖，重新下载

### Q4: 导入Swagger文档失败

**解决方案**:
1. 检查Swagger文档格式是否正确
2. 确保是有效的JSON或YAML格式
3. 检查Swagger文档是否符合OpenAPI3或Swagger2规范
4. 查看日志文件获取详细错误信息

### Q5: 数据库表未自动创建

**解决方案**:
1. 检查JPA配置：
   ```yaml
   spring:
     jpa:
       hibernate:
         ddl-auto: update  # 确保是update或create
   ```
2. 手动执行 `src/main/resources/db/schema.sql` 脚本

## 日志查看

项目日志输出到控制台，日志级别可在 `application.yml` 中配置：

```yaml
logging:
  level:
    root: INFO
    com.simulator: DEBUG  # 项目包日志级别
```

## 性能优化建议

1. **数据库连接池**: 生产环境建议配置HikariCP连接池参数
2. **JVM参数**: 生产环境建议设置合适的堆内存大小
3. **缓存**: 对于频繁查询的接口，可以考虑使用Redis缓存
4. **索引**: 确保数据库表已建立必要的索引

## 生产环境部署

1. 修改 `application.yml` 中的数据库连接为生产环境配置
2. 设置 `spring.jpa.hibernate.ddl-auto=validate` 或 `none`
3. 配置日志文件输出
4. 使用Nginx等反向代理
5. 配置HTTPS
6. 设置合适的JVM参数

## 技术支持

如遇到问题，请查看：
1. 项目README.md文档
2. 数据库设计文档
3. 日志文件
4. 联系项目维护者

